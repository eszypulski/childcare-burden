<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Infant Care Costs</title>
    <!-- d3 hookup-->
    <script src="https://d3js.org/d3.v7.min.js"></script>

    <!-- Add fonts here-->

    <!-- stylesheet-->
    <link rel="stylesheet" href="stylesheets/styles.css">

</head>

<body>

    <div id="areachart"></div>
    <script type="text/javascript">


        //Code adapted from https://www.d3-graph-gallery.com/graph/area_basic.html

        // CHART DIMENSIONS AND MARGINS
        const width = 928;
        const height = 500;
        const marginTop = 20;
        const marginRight = 30;
        const marginBottom = 30;
        const marginLeft = 40;

        // DATA

        d3.csv("datasets/ccdata.csv").then(data => {
            console.log("data", data);

            data.forEach(d => {
                d.year = +d.year;
                d.county = d.county;
                d.mhi = +d.mhi;
                d.totalpop = +d.totalpop;
                d.mcinfant = +d.mcinfant;
                d.careburden = +d.careburden;
                d.benchmark = +d.benchmark;
            });

            // X HORIZONTAL POSITION SCALE
            //const x = d3.scaleUtc(d3.extent(aapl, d => d.date), [marginLeft, width - marginRight]);  //ORIGINAL CODE FROM EXAMPLE

            const xScale = d3.scaleLinear()
            .domain(d3.extent(data, d => d.year))
                .range([marginLeft, width - marginRight]);

            // Y VERTICAL POSITION SCALE
            //  const y = d3.scaleLinear([0, d3.max(aapl, d => d.close)], [height - marginBottom, marginTop]); //ORIGINAL CODE FROM EXAMPLE
            const yScale = d3.scaleLinear()
                .domain([40000, 80000])
                .range([height - marginBottom, marginTop]);

            // AREA GENERATOR
            const areaMHI = d3.area()
                .x(d => x(d.year))
                .y0(yScale(0))
                .y1(d => yScale(d.mhi));

            // CREATE SVG ELEMENT
            const svg = d3.select("#areachart")
                .append("svg")
                .attr("width", width)
                .attr("height", height);
            .attr("viewBox", [0, 0, width, height]) //FROM EXAMPLE
            .attr("style", "max-width: 100%; height: auto;"); // FROM EXAMPLE       

            // APPEND A PATH FOR THE AREA (UNDER THE AXES).
            svg.append("path")
            .datum(data)
                .attr("d", areaMHI)
                .attr("fill", "steelblue")
                .attr("d", areaMHI(data));


            // ADD THE X AXIS
            svg.append("g")
                .attr("transform", `translate(0,${height - marginBottom})`) //FROM EXAMPLE
                .call(d3.axisBottom(x).ticks(width / 80).tickSizeOuter(0));

            // ADD THE Y AXIS, REMOVE THE DOMAIN LINE, ADD GRID LINES AND A LABEL.
            svg.append("g")
                .attr("transform", `translate(${marginLeft},0)`)
                .call(d3.axisLeft(yScale).ticks(height / 40))
                .call(g => g.select(".domain").remove())
                .call(g => g.selectAll(".tick line").clone()
                    .attr("x2", width - marginLeft - marginRight)
                    .attr("stroke-opacity", 0.1))
                .call(g => g.append("text")
                    .attr("x", -marginLeft)
                    .attr("y", 10)
                    .attr("fill", "currentColor")
                    .attr("text-anchor", "start")
                    .text("test label"));       // LABEL TEXT GOES HERE

                  return svg.node();    //FROM EXAMPLE
}

        ); //END OF DATA FUNCTION